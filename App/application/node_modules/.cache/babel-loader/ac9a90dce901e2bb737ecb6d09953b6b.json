{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _zeros = require('../../utilities/zeros');\n\nvar _zeros2 = _interopRequireDefault(_zeros);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n/**\n * A matrix\n * @param {Number} [rows]\n * @param {Number} [columns]\n * @constructor\n */\n\n\nvar Matrix = function () {\n  function Matrix(rows, columns) {\n    _classCallCheck(this, Matrix);\n\n    if (rows === undefined) return;\n    if (columns === undefined) return;\n    this.rows = rows;\n    this.columns = columns;\n    this.weights = (0, _zeros2.default)(rows * columns);\n    this.deltas = (0, _zeros2.default)(rows * columns);\n  }\n  /**\n   *\n   * @param {Number} row\n   * @param {Number} col\n   * @returns {Float32Array|Array}\n   */\n\n\n  _createClass(Matrix, [{\n    key: 'getWeights',\n    value: function getWeights(row, col) {\n      // slow but careful accessor function\n      // we want row-major order\n      var ix = this.columns * row + col;\n      if (ix < 0 && ix >= this.weights.length) throw new Error('get accessor is skewed');\n      return this.weights[ix];\n    }\n    /**\n     *\n     * @param {Number} row\n     * @param {Number} col\n     * @param v\n     * @returns {Matrix}\n     */\n\n  }, {\n    key: 'setWeight',\n    value: function setWeight(row, col, v) {\n      // slow but careful accessor function\n      var ix = this.columns * row + col;\n      if (ix < 0 && ix >= this.weights.length) throw new Error('set accessor is skewed');\n      this.weights[ix] = v;\n    }\n    /**\n     *\n     * @param {Number} row\n     * @param {Number} col\n     * @param v\n     * @returns {Matrix}\n     */\n\n  }, {\n    key: 'setDeltas',\n    value: function setDeltas(row, col, v) {\n      // slow but careful accessor function\n      var ix = this.columns * row + col;\n      if (ix < 0 && ix >= this.weights.length) throw new Error('set accessor is skewed');\n      this.deltas[ix] = v;\n    }\n    /**\n     *\n     * @returns {{rows: *, columns: *, weights: Array}}\n     */\n\n  }, {\n    key: 'toJSON',\n    value: function toJSON() {\n      return {\n        rows: this.rows,\n        columns: this.columns,\n        weights: this.weights.slice(0)\n      };\n    }\n  }, {\n    key: 'weightsToArray',\n    value: function weightsToArray() {\n      var deltas = [];\n      var row = 0;\n      var column = 0;\n\n      for (var i = 0; i < this.weights.length; i++) {\n        if (column === 0) {\n          deltas.push([]);\n        }\n\n        deltas[row].push(this.weights[i]);\n        column++;\n\n        if (column >= this.columns) {\n          column = 0;\n          row++;\n        }\n      }\n\n      return deltas;\n    }\n  }, {\n    key: 'deltasToArray',\n    value: function deltasToArray() {\n      var deltas = [];\n      var row = 0;\n      var column = 0;\n\n      for (var i = 0; i < this.deltas.length; i++) {\n        if (column === 0) {\n          deltas.push([]);\n        }\n\n        deltas[row].push(this.deltas[i]);\n        column++;\n\n        if (column >= this.columns) {\n          column = 0;\n          row++;\n        }\n      }\n\n      return deltas;\n    }\n  }], [{\n    key: 'fromJSON',\n    value: function fromJSON(json) {\n      var matrix = new Matrix(json.rows, json.columns);\n\n      for (var i = 0, max = json.rows * json.columns; i < max; i++) {\n        matrix.weights[i] = json.weights[i]; // copy over weights\n      }\n\n      return matrix;\n    }\n    /**\n     *\n     * @param weightRows\n     * @param [deltasRows]\n     * @returns {Matrix}\n     */\n\n  }, {\n    key: 'fromArray',\n    value: function fromArray(weightRows, deltasRows) {\n      var rows = weightRows.length;\n      var columns = weightRows[0].length;\n      var m = new Matrix(rows, columns);\n      deltasRows = deltasRows || weightRows;\n\n      for (var rowIndex = 0; rowIndex < rows; rowIndex++) {\n        var weightValues = weightRows[rowIndex];\n        var deltasValues = deltasRows[rowIndex];\n\n        for (var columnIndex = 0; columnIndex < columns; columnIndex++) {\n          m.setWeight(rowIndex, columnIndex, weightValues[columnIndex]);\n          m.setDeltas(rowIndex, columnIndex, deltasValues[columnIndex]);\n        }\n      }\n\n      return m;\n    }\n  }]);\n\n  return Matrix;\n}();\n\nexports.default = Matrix;","map":null,"metadata":{},"sourceType":"script"}